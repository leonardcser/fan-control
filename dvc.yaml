stages:
  preprocess:
    cmd: python -m fan_control.pipeline.preprocess
    deps:
      - data/raw
      - src/fan_control/pipeline/preprocess.py
    params:
      - preprocess
    outs:
      - data/processed:
          cache: false

  train:
    cmd: python -m fan_control.pipeline.train
    deps:
      - data/processed
      - src/fan_control/pipeline/train.py
      - src/fan_control/models/
    params:
      - model.type
      - model.features
      - model.${model.type}
    outs:
      - out/models/${model.type}/
    metrics:
      - out/metrics/train_metrics.json:
          cache: false

  evaluate:
    cmd: python -m fan_control.pipeline.evaluate
    deps:
      - data/processed/val.csv
      - out/models/${model.type}/
      - src/fan_control/pipeline/evaluate.py
      - src/fan_control/models/
    params:
      - model.type
      - evaluate.horizons
    metrics:
      - out/metrics/val_metrics.json:
          cache: false
