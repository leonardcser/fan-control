schema: '2.0'
stages:
  preprocess:
    cmd: python -m fan_control.pipeline.preprocess
    deps:
    - path: data/raw
      hash: md5
      md5: 382624fb978884f02639a9bf349389b0.dir
      size: 18229669
      nfiles: 1
    - path: src/fan_control/pipeline/preprocess.py
      hash: md5
      md5: f788fbda62214be03bf8113b27442cb2
      size: 17741
    params:
      params.yaml:
        preprocess:
          min_power:
            cpu: 10.0
            gpu: 5.0
          max_temp:
            cpu: 95.0
            gpu: 85.0
          test_size: 0.2
    outs:
    - path: data/processed
      hash: md5
      md5: a6b06759d708156abd203941343be835.dir
      size: 21593123
      nfiles: 11
  train:
    cmd: python -m fan_control.pipeline.train
    deps:
    - path: data/processed/train.csv
      hash: md5
      md5: 7c2a1408a520510bec359da528862f3f
      size: 14261323
    - path: data/processed/val.csv
      hash: md5
      md5: 74861f1dc3c653649bb49126987306d2
      size: 3545623
    - path: src/fan_control/models/
      hash: md5
      md5: 06c90d1fc603876016915106694197ac.dir
      size: 151173
      nfiles: 12
    - path: src/fan_control/pipeline/train.py
      hash: md5
      md5: ea6115b7b019dcad97a02954fdf7b4c1
      size: 2312
    params:
      params.yaml:
        model.features:
          state:
          - T_cpu
          - T_gpu
          control:
          - pwm2
          - pwm4
          - pwm5
          disturbance:
          - P_cpu
          - P_gpu
          - T_amb
          targets:
          - T_cpu
          - T_gpu
        model.physics:
          dt: 1.0
          C_cpu: 100.0
          C_gpu: 80.0
          G_cpu_base: 1.0
          G_gpu_base: 0.8
          G_cpu_pwm2: 0.05
          G_cpu_pwm4: 0.02
          G_cpu_pwm5: 0.02
          G_gpu_pwm2: 0.01
          G_gpu_pwm4: 0.03
          G_gpu_pwm5: 0.04
        model.type: physics
    outs:
    - path: out/train/logs
      hash: md5
      md5: d751713988987e9331980363e24189ce.dir
      size: 0
      nfiles: 0
    - path: out/train/metrics.json
      hash: md5
      md5: 08ea03d424b5683e37503f5976907be1
      size: 226
    - path: out/train/models/physics/
      hash: md5
      md5: b35ebb797ba90657f506fd84a80e9fa3.dir
      size: 1552
      nfiles: 1
  evaluate:
    cmd: python -m fan_control.pipeline.evaluate
    deps:
    - path: data/processed/val.csv
      hash: md5
      md5: 74861f1dc3c653649bb49126987306d2
      size: 3545623
    - path: out/train/models/physics/
      hash: md5
      md5: b35ebb797ba90657f506fd84a80e9fa3.dir
      size: 1552
      nfiles: 1
    - path: src/fan_control/models/
      hash: md5
      md5: 06c90d1fc603876016915106694197ac.dir
      size: 151173
      nfiles: 12
    - path: src/fan_control/pipeline/evaluate.py
      hash: md5
      md5: 300dd0afdd00c32c0301f90d5f16e53e
      size: 24368
    params:
      params.yaml:
        evaluate.horizons:
        - 10
        - 20
        - 50
        model.type: physics
    outs:
    - path: out/evaluate/metrics.json
      hash: md5
      md5: b659b8b0976ad5591d31c2d8417ad2d8
      size: 1822
    - path: out/evaluate/plots
      hash: md5
      md5: a1f711acc5ee6a4d16e1e3b8ab8a2987.dir
      size: 526401
      nfiles: 5
