schema: '2.0'
stages:
  preprocess:
    cmd: python -m fan_control.pipeline.preprocess
    deps:
    - path: data/raw
      hash: md5
      md5: 9e94af72f5d834f2e9c4cc2f3b3d4a84.dir
      size: 3504241
      nfiles: 1
    - path: src/fan_control/pipeline/preprocess.py
      hash: md5
      md5: 5cde13a6cd4a0c0a7597b5763e3152ac
      size: 17389
    params:
      params.yaml:
        preprocess:
          min_power:
            cpu: 10.0
            gpu: 5.0
          max_temp:
            cpu: 95.0
            gpu: 85.0
          test_size: 0.2
    outs:
    - path: data/processed
      hash: md5
      md5: 9411696a2d5057bebdfcf7ddc8ea0b2b.dir
      size: 6134955
      nfiles: 11
  train:
    cmd: python -m fan_control.pipeline.train
    deps:
    - path: data/processed
      hash: md5
      md5: 9411696a2d5057bebdfcf7ddc8ea0b2b.dir
      size: 6134955
      nfiles: 11
    - path: src/fan_control/models/
      hash: md5
      md5: 14e6f90a36051356ce45499270fa9d69.dir
      size: 130922
      nfiles: 12
    - path: src/fan_control/pipeline/train.py
      hash: md5
      md5: 07afc059e2474aca70a4b7235de3aa17
      size: 1786
    params:
      params.yaml:
        model.features:
          state:
          - T_cpu
          - T_gpu
          control:
          - pwm2
          - pwm4
          - pwm5
          disturbance:
          - P_cpu
          - P_gpu
          - T_amb
          targets:
          - T_cpu
          - T_gpu
        model.gbr:
          n_estimators: 200
          max_depth: 5
          learning_rate: 0.05
          l2_regularization: 0.5
          random_state: 42
        model.type: gbr
    outs:
    - path: out/metrics/train_metrics.json
      hash: md5
      md5: 565632f81b53f15ba9b73c6a9133ebed
      size: 256
    - path: out/models/gbr/
      hash: md5
      md5: a91725379096c3ecf3708a963eff2bd3.dir
      size: 845445
      nfiles: 3
  evaluate:
    cmd: python -m fan_control.pipeline.evaluate
    deps:
    - path: data/processed/val.csv
      hash: md5
      md5: 1beb5cc4b23dc3a6e50e7ab9f3dd40e0
      size: 792352
    - path: out/models/gbr/
      hash: md5
      md5: a91725379096c3ecf3708a963eff2bd3.dir
      size: 845445
      nfiles: 3
    - path: src/fan_control/models/
      hash: md5
      md5: 14e6f90a36051356ce45499270fa9d69.dir
      size: 130922
      nfiles: 12
    - path: src/fan_control/pipeline/evaluate.py
      hash: md5
      md5: bcd048e1759720e1cf54c59bedb36fe5
      size: 11175
    params:
      params.yaml:
        evaluate.horizons:
        - 10
        - 20
        - 50
        model.type: gbr
    outs:
    - path: out/metrics/val_metrics.json
      hash: md5
      md5: e53b85f803880dd010be6a1a8b5ee9c0
      size: 1830
