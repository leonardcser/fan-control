schema: '2.0'
stages:
  preprocess:
    cmd: python -m fan_control.pipeline.preprocess
    deps:
    - path: data/raw
      hash: md5
      md5: 382624fb978884f02639a9bf349389b0.dir
      size: 18229669
      nfiles: 1
    - path: src/fan_control/pipeline/preprocess.py
      hash: md5
      md5: f788fbda62214be03bf8113b27442cb2
      size: 17741
    params:
      params.yaml:
        preprocess:
          min_power:
            cpu: 10.0
            gpu: 5.0
          max_temp:
            cpu: 95.0
            gpu: 85.0
          test_size: 0.2
    outs:
    - path: data/processed
      hash: md5
      md5: a6b06759d708156abd203941343be835.dir
      size: 21593123
      nfiles: 11
  train:
    cmd: python -m fan_control.pipeline.train
    deps:
    - path: data/processed
      hash: md5
      md5: a6b06759d708156abd203941343be835.dir
      size: 21593123
      nfiles: 11
    - path: src/fan_control/models/
      hash: md5
      md5: 7d90210f803df6baea223d8f2deed61b.dir
      size: 137826
      nfiles: 12
    - path: src/fan_control/pipeline/train.py
      hash: md5
      md5: 07afc059e2474aca70a4b7235de3aa17
      size: 1786
    params:
      params.yaml:
        model.features:
          state:
          - T_cpu
          - T_gpu
          control:
          - pwm2
          - pwm4
          - pwm5
          disturbance:
          - P_cpu
          - P_gpu
          - T_amb
          targets:
          - T_cpu
          - T_gpu
        model.physics:
          dt: 1.0
          C_cpu: 100.0
          C_gpu: 65.0
          G_cpu_base: 1.86
          G_cpu_T: 0.0
          T_ref_cpu: 60.0
          G_gpu_base: 0.8
          G_gpu_T: 0.196
          T_ref_gpu: 30.0
          G_cpu_pwm2: 0.1
          G_cpu_pwm4: 0.1
          G_cpu_pwm5: 0.1
          G_gpu_pwm2: 0.0
          G_gpu_pwm4: 0.1
          G_gpu_pwm5: 0.1
        model.type: physics
    outs:
    - path: out/metrics/train_metrics.json
      hash: md5
      md5: be4f4ca976fd0bd96ad46a326090060c
      size: 228
    - path: out/models/physics/
      hash: md5
      md5: 18dab8670234c07ebc1973ff717eafac.dir
      size: 1612
      nfiles: 1
  evaluate:
    cmd: python -m fan_control.pipeline.evaluate
    deps:
    - path: data/processed/val.csv
      hash: md5
      md5: 74861f1dc3c653649bb49126987306d2
      size: 3545623
    - path: out/models/physics/
      hash: md5
      md5: 18dab8670234c07ebc1973ff717eafac.dir
      size: 1612
      nfiles: 1
    - path: src/fan_control/models/
      hash: md5
      md5: 7d90210f803df6baea223d8f2deed61b.dir
      size: 137826
      nfiles: 12
    - path: src/fan_control/pipeline/evaluate.py
      hash: md5
      md5: bcd048e1759720e1cf54c59bedb36fe5
      size: 11175
    params:
      params.yaml:
        evaluate.horizons:
        - 10
        - 20
        - 50
        model.type: physics
    outs:
    - path: out/metrics/val_metrics.json
      hash: md5
      md5: 059f13a9a6c422a6ae47bc9511631781
      size: 1826
